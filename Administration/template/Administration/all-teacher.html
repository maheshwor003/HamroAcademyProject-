{% extends "base.html" %} {% block content %}
{% load static %}
<link rel="stylesheet" href="{% static 'css/toastr.css' %}" />
<!-- Content Wrapper. Contains page content -->
<div class="content-wrapper">
    <!-- Content Header (Page header) -->
    <div class="content-header">
        <div class="container-fluid">
            <div class="row mb-2">
                <div class="col-sm-6">
                    <h1 class="m-0">Teachers</h1>
                </div>
                <!-- /.col -->
                <div class="col-sm-6">
                    <ol class="breadcrumb float-sm-right">
                        <li class="breadcrumb-item"><a href="#">Teachers</a></li>
                        <li class="breadcrumb-item active">Add New teachers</li>
                    </ol>
                </div>
                <!-- /.col -->
            </div>
            <!-- /.row -->
        </div>
        <!-- /.container-fluid -->
    </div>
    <!-- /.content-header -->
    <!-- Main content -->
    <section class="content">
        <div class="container-fluid">
            <div class="Allpost">
                <div class="flexcreate">
                    <div>
                        <a href="{% url 'addteacher' %}" class="btn btn-primary">Add Teacher</a>
                    </div>
                    <div>
                        <input type="text" class="form-control" placeholder="Search">
                    </div>
                </div>
                <div class="postable TBL">
                    <table class="table table-striped table-bordered">
                        <thead>
                            <tr>
                                <th>Teachers ID</th>
                                <th>Teachers Name</th>
                                <th>Gender</th>
                              
                                <th>Delete</th>

                            </tr>
                        </thead>
                        <tbody id="teacherbody">
                            {% for st in teachers_view %}
                            <tr>
                                <td>{{st.id}}</td>
                                <td>{{st.name}}</td>
                                <td>{{st.sex}}</td>
                                <td> 
                                    <input type="button" data-sid="{{st.id}}" value="Delete" class="btn btn-danger btn-sm btn-del" />
                                </td>


                            </tr>
                            {% endfor %}
                        </tbody>
                    </table>

                </div>
            </div>
        </div>
    </section>
    <!-- /.content -->


</div>
<!-- /.content-wrapper -->
<footer class="main-footer ">
    <strong>Copyright  <a href="add-teacher.html ">Hamro academy</a>.</strong> All rights reserved.
    <div class="float-right d-none d-sm-inline-block ">
    </div>
</footer>

<!-- Control Sidebar -->
<aside class="control-sidebar control-sidebar-dark ">
    <!-- Control sidebar content goes here -->
</aside>
<!-- /.control-sidebar -->
</div>
<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.6.0/jquery.min.js"></script>
<script src="{% static 'js/toastr.js' %}"></script>
<script type="text/javascript ">

const BASE_URL = "http://127.0.0.1:8000/"

function getCookie(name) {
    let cookieValue = null;
    if (document.cookie && document.cookie !== '') {
        const cookies = document.cookie.split(';');
        for (let i = 0; i < cookies.length; i++) {
            const cookie = cookies[i].trim();
            // Does this cookie string begin with the name we want?
            if (cookie.substring(0, name.length + 1) === (name + '=')) {
                cookieValue = decodeURIComponent(cookie.substring(name.length + 1));
                break;
            }
        }
    }
    return cookieValue;
}
const csrftoken = getCookie('csrftoken');

     $("#teacherbody").on("click",".btn-del",function() {
    debugger;
   let id =$(this).attr("data-sid");
   let csr = csrftoken

   mydata={sid:id,csrfmiddlewaretoken: csr };
   mythis=this;
   $.ajax({
     url:"{% url 'deleteteacher' %}",
     method: "POST",
     data: mydata,
     success: function(data){
      if(data.status ==1){
        toastr.error("Teacher Deleted!");
        $(mythis).closest('tr').fadeOut();
      }
      if(data.status==0){
    
        toastr.error("Unable to Delete Teacher!");
      }
     },
   });
  });

</script>
{% endblock %}