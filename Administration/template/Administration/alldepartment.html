{% extends "base.html" %} {% block content %}
<!-- Content Wrapper. Contains page content -->
<div class="content-wrapper">
    <!-- Content Header (Page header) -->
    <div class="content-header">
        <div class="container-fluid">
            <div class="row mb-2">
                <div class="col-sm-6">
                    <h1 class="m-0">Department</h1>
                </div>
                <!-- /.col -->
                <div class="col-sm-6">
                    <ol class="breadcrumb float-sm-right">
                        <li class="breadcrumb-item"><a href="#">Department</a></li>
                        <li class="breadcrumb-item active">Add New Department</li>
                    </ol>
                </div>
                <!-- /.col -->
            </div>
            <!-- /.row -->
        </div>
        <!-- /.container-fluid -->
    </div>
    <!-- /.content-header -->
    <!-- Main content -->
    <section class="content">
        <div class="container-fluid">
            <div class="Allpost">
                <div class="flexcreate">
                    <div>
                        <a href="{% url 'adddepartment' %}" class="btn btn-primary">Add Department</a>
                    </div>
                    <div>
                        <input type="text" class="form-control" placeholder="Search">
                    </div>
                </div>
                <div class="postable TBL">
                    <table class="table table-striped table-bordered">
                        <thead>
                            <tr>

                                <th>SN</th>
                                <th>Department</th>
                                <th>Edit</th>
                                <th>Delete</th>

                            </tr>
                        </thead>

                        <tbody id="departmentview">
                            {% for st in department_list %}
                            <tr>

                                <td>{{st.pk}}</td>
                                <td>{{st.dept_name}}</td>
                                <td>
                                    <a href="{%url 'updatedepartment' st.id %}" >
                                        <button type="submit " class="btn btn-danger ">
                                   
                                  

                                    <i class='far fa-edit'></i>
                                </button>
                                    </a>
                                </td>
                                <td> 
                                    <input type="button" data-sid="{{st.pk}}" value="Delete" class="btn btn-danger btn-sm btn-del" />
                                </td>

                            </tr>
                            {% endfor %}
                        </tbody>
                    </table>
                </div>
            </div>
        </div>
    </section>
    <!-- /.content -->


</div>
<!-- /.content-wrapper -->
<footer class="main-footer ">
    <strong>Copyright  <a href="add-teacher.html ">Hamro academy</a>.</strong> All rights reserved.
    <div class="float-right d-none d-sm-inline-block ">
    </div>
</footer>

<!-- Control Sidebar -->
<aside class="control-sidebar control-sidebar-dark ">
    <!-- Control sidebar content goes here -->
</aside>
<!-- /.control-sidebar -->
</div>
<script src="../../static/js/toastr.js "></script>
<script class="jsbin " src="https://ajax.googleapis.com/ajax/libs/jquery/1/jquery.min.js "></script>
<script type="text/javascript ">
   function getCookie(name) {
    let cookieValue = null;
    if (document.cookie && document.cookie !== '') {
        const cookies = document.cookie.split(';');
        for (let i = 0; i < cookies.length; i++) {
            const cookie = cookies[i].trim();
            // Does this cookie string begin with the name we want?
            if (cookie.substring(0, name.length + 1) === (name + '=')) {
                cookieValue = decodeURIComponent(cookie.substring(name.length + 1));
                break;
            }
        }
    }
    return cookieValue;
}
const csrftoken = getCookie('csrftoken');

     $("#departmentview").on("click",".btn-del",function() {
    debugger;
   let id =$(this).attr("data-sid");
   let csr = csrftoken

   mydata={sid:id,csrfmiddlewaretoken: csr };
   mythis=this;
   $.ajax({
     url:"{% url 'delete_department' %}",
     method: "POST",
     data: mydata,
     success: function(data){
      if(data.status ==1){
        toastr.error("Teacher Deleted!");
        $(mythis).closest('tr').fadeOut();
      }
      if(data.status==0){
    
        toastr.error("Unable to Delete Teacher!");
      }
     },
   });
  });

</script>
{% endblock %}